<!doctype html><html lang=en-US.UTF8><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Just Do It ! 행동하지 않으면 성공도 실패도 없다"><meta property="og:type" content="article"><meta property="og:image" content="https://jupilhwang.github.io//img/home-bg.jpg"><meta property="twitter:image" content="https://jupilhwang.github.io//img/home-bg.jpg"><meta name=title content="Network Overlay"><meta property="og:title" content="Network Overlay"><meta property="twitter:title" content="Network Overlay"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="og:url" content="https://jupilhwang.github.io/post/networkoverlay/"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=https://jupilhwang.github.io/img/favicon.ico><title>Network Overlay | </title><link rel=canonical href=https://jupilhwang.github.io/post/networkoverlay/><link rel=stylesheet href=https://jupilhwang.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://jupilhwang.github.io/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://jupilhwang.github.io/css/zanshang.min.css><link rel=stylesheet href=https://jupilhwang.github.io/css/font-awesome.all.min.css><link rel=stylesheet href=https://jupilhwang.github.io/css/lightbox.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css><link rel=stylesheet href=https://jupilhwang.github.io/css/main.css><script src=https://jupilhwang.github.io/js/jquery.min.js></script><script src=https://jupilhwang.github.io/js/bootstrap.min.js></script><script src=https://jupilhwang.github.io/js/hux-blog.min.js></script><script src=https://jupilhwang.github.io/js/lazysizes.min.js></script><script src=https://jupilhwang.github.io/js/lightbox.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=https://jupilhwang.github.io/js/main.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://jupilhwang.github.io/>Just Do It ! 행동하지 않으면 성공도 실패도 없다</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=https://jupilhwang.github.io/>All Posts</a></li><li><a href=https://jupilhwang.github.io/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=https://jupilhwang.github.io/tags/vlan title=vlan>vlan
</a><a class=tag href=https://jupilhwang.github.io/tags/network title=network>network
</a><a class=tag href=https://jupilhwang.github.io/tags/network-overay title="network overay">network overay</a></div><h1>Network Overlay</h1><h2 class=subheading></h2><span class=meta>Posted by
Just Do It ! 행동하지 않으면 성공도 실패도 없다
on
Monday, October 17, 2016</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=vxlan>VXLAN</h1><p>VXLAN의 &lsquo;X&rsquo;의 의미는 <strong>eXtensible</strong>을 뜻하며, L2 Network의 Scale(확장성)을 의미한다. VLAN기반 네트워크보다 더욱 많은 Layer 2 Segment를 구성할수 있으며, VLAN숫자의 제약(<em>4000개</em>)을 극복할 수 있음을 의미함</p><h2 id=network-overlay>Network Overlay</h2><p>Network Overlay 이야기를 여기저기에서 많이 들리고는 있지만, 실제로 이것이 무엇인지에 대해선 잘 알수가 없어서 정리해 본다. 간단하게 추상화 레이어라고 하면 될까? 기존 데이터센터 네트워크망이 어떻게 구성이 되어 있던지 Network를 넘어 구성하겠다는 것이다. 요즘 나오는 SDN(Software Defined Network)와 같은 개념이지 않나 싶다.</p><ul><li><p>Network Overlay 기술</p><ul><li>MAC Over IP/UDP 기술 기반</li></ul><p>MAC Over IP/UDP : 기존 Ethernet Frame의 한계를 극복할 수 있는 것은 VXLAN이라는 MAC Over ID/UDP Header가 추가로 생성되어 Encapsulation을 할 수 있기 때문이다.</p></li></ul><p>Cisco/VMWare에 의해 IEFT에 VXLAN으로 표준 Draft됨
현재 CISCO, VMWare, Citrix, Redhat, Broadcom, Arista 등이 지지</p><h2 id=vxlan-1>VXLAN</h2><p>VXLAN Header + UDP + IP 기반으로 전송,</p><p>VXLAN Header는 24bit VXLAN Network ID로 구성됨</p><p>학습 하지 못한 목적지 VM MAC은 VXLAN기술 기반으로 IP Multicast를 이용하여 목적지 VM MAC주소가 있는 스위치에 전송 (Broadcast, Multicast, Unknown Destination)</p><p>VM MAC은 VXLAN기반의 Encapsulation된 패킷을 받아서 목적지 VM ARP Table을 학습하는 방식
학습한 목적지 VM MAC은 P2P Tunnel로 직접해당 스위치와 통신</p><h3 id=vxlan의-등장배경>VXLAN의 등장배경</h3><ul><li><p>가상화 환경에서의 네트워크 스위치들의 MAC Address Table의 한계</p><ul><li>기본적으로 서버는 과거와 달리 가상화 기반으로 구성</li><li>가상화 기반의 서버는 다량의 MAC Address Table을 보유</li><li>ToR(Top Of Rack), Access Switch 등에서 최대 수용할 수 있는 MAC의 한계</li></ul><p>일반서버들의 NIC & MAC address 숫자 (NIC 1개, Mac Address 2개)</p><p>가상화 환경에서의 NIC & MAC address 숫자
- VMWare ESXi 서버 기준으로 vNIC위한 AMC은 3개 정도 필요 이중화를 고려할때 6개의 nic가 필요</p><p>단일 STP도메인당 MAC Address Table이 100k를 넘을 수 있음.
네트워크 장비의 한계, MAC Table관리의 문제 발생</p><p>&ndash;> 따라서 네트워크스위치에서 MAC Address Table을 관리하지 않고, 하단의 가상화 vSwitch에서만 소유하고, 해당 테이블을 통해서 Fowarding 하는 방식이다.</p></li><li><p>가상화 환경에서의 VLAN 숫자의 한계</p><ul><li>Multi-Tenancy 환경에서 각 Tenancy 또는 각 VDC(Virtual DC)별로 별도의 VLAN 할당</li><li>16bit VLAN ID에서 최대 수용 가능한 VLAN숫자의 한계 (약4000개)</li></ul><p>일반적인 VLAN은 12bit ID = 4,000 Vlan : Ethernet Frame Format이 12bit VLAN ID를 제공하기 때문
VDC가 많아 질수록 Vlan숫자 부족하게 됨</p><p>16bit VLAN = 4096개만을 제공하고, 여기에 Reserve되 VLAN을 제외하면 4000개 정도로 보면 됨\</p><p>VXLAN은 VLAN ID가 26bit로 무려 16,000,000 개의 VLAN을 생성할 수 있다.</p></li><li><p>가상화 환경에서의 이동성에 대한 고민</p><ul><li>Static한 VLAN Trunk환경에서는 결국 VM이동성의 한계가 있음.</li></ul><p>VXLAN은 VLAN Trnk가 필요없다.
Multicast기반으로 알아서 Tree를 구성한다.
훨씬 더 Dynamic하고 능동적인 구성이 가능하다.</p></li></ul><h3 id=vxlan의-등장배경---vxlan이-바꿔놓은-가상화-환경>VXLAN의 등장배경 - VXLAN이 바꿔놓은 가상화 환경</h3><ul><li><p>가상화 환경에서의 MAC Address Table의 한계 극복</p><ul><li>일반적인 가상화 스위치의 Bridging 기술 적용</li><li>학습하지 못한 ARP요청에 대해서만 Multicast 기반의 Broadcast/Multicast등을 처리</li><li>STP단일 도메인에서 필요한 MAC Address는 vmkernel port숫자만 필요</li></ul></li><li><p>가상화 환경에서의 VLAN숫자의 한계</p><ul><li>VXLAN의 VLAN IDbit는 24bit로 최대 16,000,000개의 VLAN생성 가능</li><li>다양한 VDC, Multi-Tenant환경 구축 가능</li></ul></li><li><p>가상화 환경에서의 이동성에 대한 고민</p><ul><li>IGMP기반의 자동화된 prune traffic을 통해, ARP요청 시에 자동으로 갱신하는 방식</li></ul></li></ul><h3 id=vxlan-network-구조>VXLAN Network 구조</h3><h4 id=vtep-vxlan-tunnel-end-point>VTEP (VXLAN Tunnel End Point)</h4><p>참고 : <a href=http://youngmind.tistory.com/entry/Network-Overlay-VXLAN-%EB%B6%84%EC%84%9D-1>청년정신</a></p><hr><ul class=pager><li class=previous><a href=https://jupilhwang.github.io/post/oracle-cloud-pcs_doccs-rest-api-%EC%97%B0%EB%8F%99/ data-toggle=tooltip data-placement=top title>&larr;
Previous Post</a></li><li class=next><a href=https://jupilhwang.github.io/post/vlan/ data-toggle=tooltip data-placement=top title="VLAN 기본">Next
Post &rarr;</a></li></ul></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=https://jupilhwang.github.io/tags/>FEATURED TAGS</a></h5><div class=tags><a href=https://jupilhwang.github.io/tags/cloud title=cloud>cloud
</a><a href=https://jupilhwang.github.io/tags/groovy title=groovy>groovy
</a><a href=https://jupilhwang.github.io/tags/ingress title=ingress>ingress
</a><a href=https://jupilhwang.github.io/tags/k8s title=k8s>k8s
</a><a href=https://jupilhwang.github.io/tags/kafka title=kafka>kafka
</a><a href=https://jupilhwang.github.io/tags/kubernetes title=kubernetes>kubernetes
</a><a href=https://jupilhwang.github.io/tags/linux title=linux>linux
</a><a href=https://jupilhwang.github.io/tags/network title=network>network
</a><a href=https://jupilhwang.github.io/tags/oracle title=oracle>oracle
</a><a href=https://jupilhwang.github.io/tags/tanzu title=tanzu>tanzu
</a><a href=https://jupilhwang.github.io/tags/tkg title=tkg>tkg
</a><a href=https://jupilhwang.github.io/tags/vsphere title=vsphere>vsphere</a></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:jupil.hwang@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/jupil_hwang><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.facebook.com/jupilhwang><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/jupilhwang><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/namoo4u><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="Just Do It ! 행동하지 않으면 성공도 실패도 없다"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Just Do It ! 행동하지 않으면 성공도 실패도 없다 2025</p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script></body></html>